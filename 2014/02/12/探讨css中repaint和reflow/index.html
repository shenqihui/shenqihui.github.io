<!DOCTYPE html><html lang="zh-cmn-Hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="renderer" content="webkit"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>探讨 css 中 repaint 和 reflow | 神奇辉</title><meta name="author" content="神奇辉"><meta name="description" content="神奇辉,博客,blog,前端,hexo,nodejs,javascript,python,html,css,npm"><link rel="alternate" href="/atom.xml" title="神奇辉" type="application/rss2.xml"><meta name="description" content="前言：页面设计中，不可避免的需要浏览器进行 repaint 和 reflow 。那到底什么是 repaint 和 reflow 呢。下面谈谈自己对 repaint 和 reflow 的理解，以及结合其他技术牛的讲解，谈谈如何优化 repaint 和 reflow 。"><meta property="og:type" content="article"><meta property="og:title" content="探讨 css 中 repaint 和 reflow"><meta property="og:url" content="http://blog.shenqh.com/2014/02/12/探讨css中repaint和reflow/index.html"><meta property="og:site_name" content="神奇辉"><meta property="og:description" content="前言：页面设计中，不可避免的需要浏览器进行 repaint 和 reflow 。那到底什么是 repaint 和 reflow 呢。下面谈谈自己对 repaint 和 reflow 的理解，以及结合其他技术牛的讲解，谈谈如何优化 repaint 和 reflow 。"><meta property="og:updated_time" content="2015-05-12T15:54:50.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="探讨 css 中 repaint 和 reflow"><meta name="twitter:description" content="前言：页面设计中，不可避免的需要浏览器进行 repaint 和 reflow 。那到底什么是 repaint 和 reflow 呢。下面谈谈自己对 repaint 和 reflow 的理解，以及结合其他技术牛的讲解，谈谈如何优化 repaint 和 reflow 。"><meta name="twitter:creator" content="@shenqihui"><link rel="alternative" href="/atom.xml" title="神奇辉" type="application/atom+xml"><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/app.css" type="text/css"></head></html><body class="site-page"><nav class="site-navbar"><ul nav-left><h1>神奇辉</h1></ul><ul nav-right><li><a href="/">Home</a></li><li><a href="/archives">Archives</a></li><li><a href="/link">Link</a></li><li><a href="http://www.weibo.com/p/1005051896403155" target="_blank">Weibo</a></li><li><a href="https://github.com/shenqihui" target="_blank">Github</a></li><li><a href="mailto:c2hlbnFpaHVpMDkyMEBnbWFpbC5jb20K">Mail</a></li><li><a href="/atom.xml">Rss</a></li><li><a href="/about">About</a></li></ul></nav><section site-body><section post><article id="post-探讨css中repaint和reflow" layout="post"><h2 post-title>探讨 css 中 repaint 和 reflow</h2><time post-time datetime="2014-02-11T21:47:00.000Z" itemprop="datePublished">2014 年 02 月 12 日</time><div class="clearfix"></div><div page-excerpt><p><strong>前言：</strong></p><p>页面设计中，不可避免的需要浏览器进行 repaint 和 reflow 。那到底什么是 repaint 和 reflow 呢。下面谈谈自己对 repaint 和 reflow 的理解，以及结合其他技术牛的讲解，谈谈如何优化 repaint 和 reflow 。<br></p></div><div page-more><br><strong>初步介绍：</strong><p>开发一个页面时，不可避免的需要进行 repaint 和 reflow 。也就只有古来的静态页面才会不存在 repaint 和 reflow 。 repaint 主要是针对某一个 DOM 元素进行的重绘， reflow 则是回流，针对整个页面的重排。字面意思来说： repaint 就是重绘， reflow 就是回流。 repaint 和 reflow 的目的是：展示一个新的页面样貌。</p><p><strong>严重性：</strong></p><p>在性能优先的前提下，性能消耗 reflow 大于 repaint 。</p><p><strong>体现：</strong></p><p>repaint 是某个 DOM 元素进行重绘； reflow 是整个页面进行重排，也就是页面所有 DOM 元素渲染。</p><p><strong>如何触发：</strong></p><p>style 变动造成 repaint 和 reflow 。</p><p>不涉及任何 DOM 元素的排版问题的变动为 repaint ，例如元素的 color / text - align / text - decoration 等等属性的变动。</p><p>除上面所提到的 DOM 元素 style 的修改基本为 reflow 。例如元素的任何涉及长、宽、行高、边框、 display 等 style 的修改。</p><p><strong>常见触发场景：</strong></p><ol><li><p>触发 repaint ：</p><ol><li>color 的修改，如 color =# ddd ；</li><li>text - align 的修改，如 text - align = center ；</li><li>a : hover 也会造成重绘。</li><li>: hover 引起的颜色等不导致页面回流的 style 变动。</li><li>等等太多，一时间写出来也太难想了。</li></ol></li><li><p>触发 reflow ：</p><ol><li>width / height / border / margin / padding 的修改，如 width =778 px ；</li><li>动画，: hover 等伪类引起的元素表现改动， display = none 等造成页面回流；</li><li>appendChild 等 DOM 元素操作；</li><li>font 类 style 的修改；</li><li>background 的修改，注意着字面上可能以为是重绘，但是浏览器确实回流了，经过浏览器厂家的优化，部分 background 的修改只触发 repaint ，当然 IE 不用考虑；</li><li>scroll 页面，这个不可避免；</li><li>resize 页面，桌面版本的进行浏览器大小的缩放，移动端的话，还没玩过能拖动程序， resize 程序窗口大小的多窗口操作系统。</li><li>读取元素的属性（这个无法理解，但是技术达人是这么说的，那就把它当做定理吧）：读取元素的某些属性（ offsetLeft 、 offsetTop 、 offsetHeight 、 offsetWidth 、 scrollTop / Left / Width / Height 、 clientTop / Left / Width / Height 、 getComputedStyle ()、 currentStyle ( in IE ))；</li></ol></li></ol><p><strong>如何避免：</strong></p><p>说避免那是不可能的，不然就是以前古老的静态页面了，没有交互，那在现在看来，就是一个失败的作品。所以，在我们进行网页设计的时候，就必须尽量减少页面的 repaint 和 reflow 。 repaint 和 reflow 的目的是为了展示一个新的页面，那么我们在进行页面交互时，尽量通过各种方法减少 repaint 和 reflow 但又能展示一个新的页面的目的。所以下面将结合其他技术达人的建议，通过自己的理解，给大家讲解如何避免和优化 repaint 和 reflow ：</p><p>下面是大神 Nicole Sullivan 的原话：</p><blockquote><ol><li>Change classes on the element you wish to style ( as low in the dom tree as possible )</li><li>Avoid setting multiple inline styles</li><li>Apply animations to elements that are position fixed or absolute</li><li>Trade smoothness for speed</li><li>Avoid tables for layout</li><li>Avoid JavaScript expressions in the CSS ( IE only )</li></ol></blockquote><ol><li><strong>尽可能在 DOM 末梢通过改变 class 来修改元素的 style 属性</strong>：尽可能的减少受影响的 DOM 元素。</li><li><strong>避免设置多项内联样式</strong>：使用常用的 class 的方式进行设置样式，以避免设置样式时访问 DOM 的低效率。</li><li><strong>设置动画元素 position 属性为 fixed 或者 absolute</strong>：由于当前元素从 DOM 流中独立出来，因此受影响的只有当前元素，元素 repaint 。</li><li><strong>牺牲平滑度满足性能</strong>：动画精度太强，会造成更多次的 repaint / reflow ，牺牲精度，能满足性能的损耗，获取性能和平滑度的平衡。</li><li><strong>避免使用 table 进行布局</strong>： table 的每个元素的大小以及内容的改动，都会导致整个 table 进行重新计算，造成大幅度的 repaint 或者 reflow 。改用 div 则可以进行针对性的 repaint 和避免不必要的 reflow 。</li><li><strong>避免在 CSS 中使用运算式</strong>：学习 CSS 的时候就知道，这个应该避免，不应该加深到这一层再去了解，因为这个的后果确实非常严重，一旦存在动画性的 repaint / reflow ，那么每一帧动画都会进行计算，性能消耗不容小觑。</li></ol><p><strong>参考文献：</strong></p><ol><li><a href="/http :// www . blueidea . com / tech / web /2011/8365. asp" title=" http :// www . blueidea . com / tech / web /2011/8365. asp ">页面重构应注意的 repaint 和 reflow</a></li><li><a href="/http :// blog . csdn . net / baiduforum / article / details /5415527" title="如何减少浏览器 repaint 和 reflow （上）">如何减少浏览器 repaint 和 reflow （上）</a></li><li><a href="/http :// www . zhangxinxu . com / wordpress /2010/01/% E 5%9 B %9 E % E 6% B 5%81% E 4% B 8%8 E % E 9%87%8 D % E 7% BB %98% EF % BC %9 Acss % E 6%80% A 7% E 8%83% BD % E 8% AE % A 9 javascript % E 5%8 F %98% E 6%85% A 2% EF % BC %9 F /" title="回流与重绘： CSS 性能让 JavaScript 变慢？">回流与重绘： CSS 性能让 JavaScript 变慢？</a></li><li><a href="/http :// www . stubbornella . org / content /2009/03/27/ reflows - repaints - css - performance - making - your - javascript - slow /" title=" Permanent   Link :  Reflows  &amp; amp ;  Repaints :  CSS   Performance   making   your   JavaScript   slow ?">Reflows &amp; amp ; Repaints : CSS Performance making your JavaScript slow ?</a></li></ol><p>觉得有用，点个赞，赞赞更健康。</p></div><div social-line><a data-url="http://blog.shenqh.com/2014/02/12/探讨css中repaint和reflow/" data-id="cil0ko813000hygazbemfk222">Share</a> <a href="http://blog.shenqh.com/2014/02/12/探讨css中repaint和reflow/#disqus_thread">Comments</a></div><nav class="pagination"><a post-prev href="/2014/02/12/探讨javascript面向对象编程/" title="探讨javascript面向对象编程">&#10094; 探讨javascript面向对象编程</a> <a post-next href="/2014/02/08/汤姆大叔设计模式学习体会：设计模式的思想/" title="汤姆大叔设计模式学习体会：设计模式的思想">汤姆大叔设计模式学习体会：设计模式的思想 &#10095;</a></nav></article><section id="comments"><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></section></section></section><section site-body class="dn"><nav><a href="/tags/XDomainRequest/" style="font-size:10px;color:#777">XDomainRequest</a> <a href="/tags/ajax/" style="font-size:10px;color:#777">ajax</a> <a href="/tags/color/" style="font-size:10px;color:#777">color</a> <a href="/tags/corf/" style="font-size:10px;color:#777">corf</a> <a href="/tags/django/" style="font-size:10px;color:#777">django</a> <a href="/tags/ellipsis/" style="font-size:10px;color:#777">ellipsis</a> <a href="/tags/ie/" style="font-size:10px;color:#777">ie</a> <a href="/tags/javascript/" style="font-size:20px;color:#111">javascript</a> <a href="/tags/life/" style="font-size:10px;color:#777">life</a> <a href="/tags/nodejs/" style="font-size:10px;color:#777">nodejs</a> <a href="/tags/proxy/" style="font-size:20px;color:#111">proxy</a> <a href="/tags/table/" style="font-size:10px;color:#777">table</a> <a href="/tags/travel/" style="font-size:10px;color:#777">travel</a> <a href="/tags/warp/" style="font-size:10px;color:#777">warp</a> <a href="/tags/web/" style="font-size:10px;color:#777">web</a> <a href="/tags/websocket/" style="font-size:10px;color:#777">websocket</a> <a href="/tags/前端/" style="font-size:10px;color:#777">前端</a> <a href="/tags/技术/" style="font-size:20px;color:#111">技术</a> <a href="/tags/旅游/" style="font-size:20px;color:#111">旅游</a> <a href="/tags/海南/" style="font-size:10px;color:#777">海南</a> <a href="/tags/西藏/" style="font-size:10px;color:#777">西藏</a> <a href="/tags/部署脚本/" style="font-size:10px;color:#777">部署脚本</a> <a href="/tags/骑行/" style="font-size:10px;color:#777">骑行</a></nav></section><footer site-footer><div copyright>&copy; 2016 神奇辉<h4>吾十有五而志于养猪，三十始养，四十亏本，五十再亏，六十亏大了，七十卒，不逾矩。现廿五，将卒。</h4></div><div powered><b><a href="https://github.com/shenqihui/hexo-theme-pithy" target="_blank">Pithy</a></b> Hexo Theme designed by <b><a href="http://blog.shenqh.com/" target="_blank">shenqihui</a></b>, Powered by <b><a href="http://hexo.io/" target="_blank">Hexo</a></b> and <b><a href="https://pages.github.com/">Github Pages</a></b>. <b><a href="/sitemap.xml">Sitemap</a></b> .</div><div footer_word>我们俩都是年轻人，要将自己献身于伟大事业的开创，我们是天生的魔术师，但我们不会用自己的天赋去伤害任何人。 -- 阿尔弗雷德·波登 《致命魔术》</div></footer><script>var disqus_shortname="shenqihuiblog",disqus_url="http://blog.shenqh.com/2014/02/12/探讨css中repaint和reflow/";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}();</script></body>
Slide.Control.add("postMessage",function(e,n){function t(e){var n={};return(e||location.search.substring(1)).split("&").forEach(function(e){e=e.split("="),n[e[0].toLowerCase()]=e[1]}),n}n.on("controlEvent:joinClient",function(){s.send_default("syncStatus",{id:e.current,item:e.curItem})});var o,i,r,s={role:"",send_default:function(e,n){var t=o?o:i;t&&t.postMessage({action:"controlEvent:"+e,data:n},"*")},send_keyEvent:function(e){s.send_default("keyEvent",{keyCode:e})},evtHandler:function(e){var t=e.data;n.fire(t.action,t.data)},closeClient:function(){i&&i.close(),r&&clearInterval(r)},init:function(e){var n=t();if("1"===n._multiscreen){this.role="client";var r=location.href.replace("_multiscreen=1","_multiscreen=control"),a=screen.width,l=screen.height,c=.8*a,d=.8*l,u="height="+d+",width="+c+",top=10,left="+(a-c)/2+",toolbar=no,menubar=no,location=yes,resizable=yes,scrollbars=no,status=no";i=window.open(r,"ppt",u),window.addEventListener("message",this.evtHandler,!1),window.addEventListener("beforeunload",this.closeClient,!1)}else"control"===n._multiscreen&&(this.role="control",Slide.proxyFn=function(e,n){n=JSON.stringify(n),s.send_default("proxyFn",{fnName:e,args:n})},Slide.timerCtrl(),o=window.opener,s.send_default("joinClient"),window.addEventListener("message",this.evtHandler,!0))}};return s});
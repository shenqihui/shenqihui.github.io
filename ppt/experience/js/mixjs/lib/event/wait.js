MixJS.define("event/wait",function(t){function i(){return"Theo"+r++}function n(){return this instanceof n?void this.init():new n}function s(i){var n=arguments.callee;for(var s in i)i.hasOwnProperty(s)&&(t.isArray(i[s])?i[s].length=0:"object"==typeof i[s]&&n(i[s]),delete i[s])}var r=+new Date;return n.prototype={constructor:n,init:function(){this.list={},this.cbMap={},this.uuid2Evts={},this._cbMap={}},on:function(n,s,r){if(!t.isFunction(s)||!n)return this;r=r||null,n=t.isArray(n)?n:n.split(",");var e=i();return this.cbMap[e]={fn:s,scope:r},this._cbMap[s]=e,t.each(n,function(t,i){this.list[t]=this.list[t]||{handlers:[],data:"",state:0},(this.uuid2Evts[e]=this.uuid2Evts[e]||[]).push(t),this.list[t].handlers.push(e)},this),this},_findCanCallbacks:function(t){for(var i=[],n=0,s=t.length;s>n;n++){for(var r=t[n],e=this.uuid2Evts[r],a=!0,h=[],u=0,o=e.length;o>u;u++){var c=this.list[e[u]];if(0===c.state){a=!1;break}h.push(c.data)}a&&(this.cbMap[r].args=h,i.push(this.cbMap[r]))}return i},fire:function(t,i){var n=this.list[t];if(!n)return this;n.state=1,n.data=i||"";var s=n.handlers;for(s=this._findCanCallbacks(s);s[0];){var r=s.shift(),e=r.scope,a=r.args;r.fn.apply(e,a)}return this},un:function(i,n){if(t.isUndefined(i)||!t.isFunction(n))return this;var s=this.list[i];if(!s)return this;for(var r=this._cbMap[n],e=s.handlers,a=e.length;a--;)if(r===e[a]){e.splice(a,1);break}return delete this._cbMap[n],this},removeAll:function(){this.destroy(),this.init()},destroy:function(){s(this)}},function(){return new n}});